!function(t){function e(i){if(a[i])return a[i].exports;var r=a[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var a={};e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,i){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1973)}({1973:function(t,e,a){t.exports=a(8)},8:function(t,e){function a(t){switch(t){case"Move_Generate_Abs":return"Generate";case"Move_Bleed_Perc":return"MoveBleedImprove";case"Move_Destroy_Abs":return"GemDestroy";case"Move_Steal_Perc":return"MoveStealImprove";case"Move_Submission_Dmg_Perc":return"MoveSubmissionDamage";case"Move_Dmg_Perc":case"Move_StartCharge_Abs":return"MoveEffectImprove";case"ModGem_Effect_Heal_Perc":return"GemEffectImprove";default:return"None"}}$(document).ready(function(){function t(t){$(".btn-equip-ability").each(function(e){-1!==t.indexOf(e)&&$(this).trigger("click")})}function e(t){for(var e in C){var a=C[e];if(a.ID==t)return a}return!1}function i(t,a){var i=e(t);if(i)for(var r in i.levels){var n=i.levels[r];if(n.level==a)return n}return!1}function r(){var t=[];for(var e in C){var a=C[e];t.push(a.Name+' "'+a.NickName+'"');var i=p(a);$(".add-trainers-list").append(i)}}function n(t){var a=e(t);if(a){var i=c(a);return $(".added-trainers").append(i),!0}return!1}function s(){M=_[k][S]}function l(t){$("#wrestlerLevelUI").text(M.LevelCap+"/"+M.LevelCap),$("#wrestlerMaxLevel").val(M.LevelCap),$("#wrestlerLevelInput").prop("min",1),$("#wrestlerLevelInput").prop("max",M.LevelCap),$("#wrestlerLevelInput").val(M.LevelCap),o(M.Abilities),d(M.LevelCap)}function d(t){var e=$("#wrestlerLevelInput").val()||1;t&&(e=t);var a=u(e);$(".gem-stat").removeClass("trainer-buff-modification"),$("#statsTalentScore").val(a.TalentScore),$("#stat-hp").text(a.HP),$("#stat-red").text(a.Red).attr("data-variable-value",a.Red),$("#stat-black").text(a.Black).attr("data-variable-value",a.Black),$("#stat-yellow").text(a.Yellow).attr("data-variable-value",a.Yellow),$("#stat-blue").text(a.Blue).attr("data-variable-value",a.Blue),$("#stat-green").text(a.Green).attr("data-variable-value",a.Green),$("#stat-purpel").text(a.Purpel).attr("data-variable-value",a.Purpel),f()}function f(){var t=parseInt($("#statsTalentScore").val()),e=0;$(".row.ability.equipped").each(function(t){var a=$(this).find('input[name="talent-score"]').first().val();e+=parseInt(a)});var a=parseInt((t+e+414)/2.2);$("#stat-talent").text(a)}function p(t){return $("<a/>",{class:"list-group-item add-trainer",href:"#","data-trainer-id":t.ID}).on("click",function(t){t.preventDefault(),$("#addTrainerModal").modal("hide"),n($(this).attr("data-trainer-id"))}).append($("<div/>",{class:"row"}).append($("<div/>",{class:"col-xs-3"}).append($("<div/>",{class:"added-trainer-thumbnail",style:'background-image:url("/img/Portraits/'+t.Portrait+'")'}))).append($("<div/>",{class:"col-xs-9"}).append($("<h4/>",{style:"margin-top:0;",class:"wrestler-name",text:t.Name+' "'+t.NickName+'"'})).append($("<p/>",{text:t.levels[0].text}))))}function c(t){return $("<div/>",{style:"margin-bottom:15px;",class:"row trainer","data-trainer-id":t.ID,"data-activated":"false","data-buff-gem-type":t.buffGemType,"data-buff-move-type":t.buffMoveType,"data-buff-value":t.levels[0].buffValue}).append($("<div/>",{class:"col-xs-12"}).append($("<h4/>",{text:t.Name+' "'+t.NickName+'"'})).append($("<div/>",{class:"row"}).append($("<div/>",{class:"col-xs-3"}).append($("<div/>",{class:"added-trainer-thumbnail",style:'background-image:url("/img/Portraits/'+t.Portrait+'")'}))).append($("<div/>",{class:"col-xs-9"}).append($("<div/>",{class:"row"}).append($("<div/>",{class:"col-xs-3 text-left"}).append($("<button/>",{class:"btn btn-danger",html:'<i class="fa fa-trash-o"></i>'}).on("click",function(){$(this).closest(".trainer").first().find("button.deactivate-trainer-effect").first().trigger("click"),$(this).closest(".trainer").first().remove()}))).append($("<div/>",{class:"col-xs-6 text-center"}).append($("<span/>",{class:"trainer-talent-score",text:t.levels[0].talentScore+"/"+t.maxTalentScore}))).append($("<div/>",{class:"col-xs-3 text-right"}).append($("<button/>",{class:"btn btn-success activate-trainer-effect",html:'<i class="fa fa-check"></i>'}).on("click",function(){$(this).addClass("hidden"),$(this).closest(".trainer").first().find(".deactivate-trainer-effect").removeClass("hidden"),$(this).closest(".trainer").first().attr("data-activated","true"),o(M.Abilities,!0),d(),I()})).append($("<button/>",{class:"btn btn-primary deactivate-trainer-effect hidden",html:'<i class="fa fa-ban"></i>'}).on("click",function(){$(this).addClass("hidden"),$(this).closest(".trainer").first().find(".activate-trainer-effect").removeClass("hidden"),$(this).closest(".trainer").first().attr("data-activated","false"),o(M.Abilities,!0),d(),I()})))).append($("<div/>",{class:"row",style:"margin-top:8px;"}).append($("<div/>",{class:"col-xs-12"}).append($("<p/>",{class:"trainer-buff-text",text:t.levels[0].text})))).append($("<div/>",{class:"row",style:"margin-top:0px;"}).append($("<div/>",{class:"col-xs-11"}).append($("<input/>",{class:"trainer-level",type:"range",name:"trainer-level",min:"1",max:t.levels.length,value:"1"}).on("input",function(){var e=parseInt($(this).val()),a=($(this).attr("max"),$($(this).closest(".trainer").first())),r=a.attr("data-activated"),n=a.find(".trainer-buff-text").first(),s=a.find(".trainer-talent-score").first(),l=a.attr("data-trainer-id"),f=i(l,e);parseInt(a.attr("data-buff-value")),f.buffValue;a.attr("data-buff-value",f.buffValue),s.empty(),s.text(f.talentScore+"/"+t.maxTalentScore),n.empty(),n.text(f.text),"true"===r&&(o(M.Abilities,!0),d(),I())})))))))}function v(t,e){return e=e||t.levelCap,$("<div/>",{class:"row ability",sylte:"margin-bottom:10px;","data-buffed-id":t.move.AffectedValueID,"data-gem-type":t.gemType,"data-effects":JSON.stringify(t.move.Effects)}).append($("<input/>",{type:"hidden",value:t.levels[e-1].talentScore,name:"talent-score"})).append($("<div/>",{class:"col-xs-3"}).append($("<img/>",{src:"/img/Gems/"+t.gemType+".png",width:45,height:45,alt:t.gemType+" Gem",class:"center-block"})).append($("<p/>",{html:'<span class="ability-mp">0</span> / <span class="ability-cost">'+t.cost+"</span>",class:"text-center"})).append($("<p/>",{class:"text-center"}).append($("<button/>",{class:"btn btn-xs btn-primary btn-equip-ability",html:"Equip"}).on("click",function(){var t=$($(this).closest(".ability").first());$(this).hasClass("btn-primary")?($(this).removeClass("btn-primary"),$(this).addClass("btn-success"),t.addClass("equipped"),$(this).text("Equipped")):($(this).removeClass("btn-success"),$(this).addClass("btn-primary"),t.removeClass("equipped"),$(this).text("Equip")),f()})))).append($("<div/>",{class:"col-xs-9"}).append($("<div/>",{class:"row"}).append($("<div/>",{class:"col-xs-12"}).append($("<p/>").append($("<strong/>",{text:t.name})))).append($("<div/>",{class:"col-xs-12"}).append($("<p/>",{html:t.levels[e-1].html,class:"ability-text"}))).append($("<div/>",{class:"col-xs-11"}).append($("<div/>",{class:"level-selector"}).append($("<p/>").append($("<span/>",{text:e,class:"abilitySelectedLevel"})).append("/").append($("<span/>",{text:t.levelCap,class:"abilityMaxLevel"}))).append($("<input/>",{type:"range",name:"ability-level",min:1,max:t.levelCap,value:e}).on("input",function(){var t=$(this).val(),e=$(this).parent().find(".abilitySelectedLevel").first(),a=$($(this).closest(".ability").first()),i=a.find(".ability-text").first(),r=a.find('input[name="talent-score"]').first(),n=$(this).next().val(),s=b(n,t);e.text(t),i.html(s.html),r.val(s.talentScore),a.find(".ability-mp").first().text(0),d(),I(a)})).append($("<input/>",{class:"ability-id",name:"ability-id",type:"hidden",value:t.ID}))))))}function o(e,a){var i=[],r=[0,1,2];a&&(r=[],$('input[name="ability-level"]').each(function(){i.push(parseInt($(this).val()))}),$(".row.ability").each(function(t){$(this).hasClass("equipped")&&r.push(t)})),$("#abilities").empty(),e.forEach(function(t,e,r){if(a&&i&&i.length>0){var n=i[e];$("#abilities").append(v(t,n))}else $("#abilities").append(v(t))}),t(r)}function u(t){for(var e in M.Stats){var a=M.Stats[e];if(a.level==t)return a.stats}}function m(t){var e=M.Abilities;for(var a in e)if(e[a].ID==t)return e[a];return!1}function b(t,e){var a=m(t),i=a.levels;for(var r in i)if(i[r].level==e)return i[r];return!1}function h(t,e,a,i,r,n){if(-1!==$.inArray(t,e)){if("Generate"==t||"GemDestroy"==t){var s=a.find("span[data-variable-name='"+i+"']");if(s&&s.length){var l=s.first().attr("data-variable-value");if(r==l)return!0}}else if("MoveEffectImprove"==t){if(r==n)return!0}else if("GemEffectImprove"==t){var s=a.find("span[data-variable-name='min2']");if(s&&s.length){var l=s.first().attr("data-variable-value");if("Heal"==l)return!0}}else if("MoveSubmissionDamage"==t||"MoveStealImprove"==t||"MoveBleedImprove"==t)return!0;return!1}return!1}function x(t,e,a,i){if("Move_Bleed_Perc"==i){var r=t.find("span[data-variable-name='val2']").first();r.addClass("trainer-buff-modification");var n=r.attr("data-variable-value"),s=r.text(),l=parseInt(n)*e,d=parseInt(s)+l;r.text(d)}if("Move_Destroy_Abs"==i){var f=t.find("span[data-variable-name='val1']").first();f.addClass("trainer-buff-modification");var d=parseInt(f.text())+e;f.text(d)}if("Move_Generate_Abs"==i){var f=t.find("span[data-variable-name='val1']").first();f.addClass("trainer-buff-modification");var d=parseInt(f.text())+e;f.text(d)}if("Move_Dmg_Perc"==i){var r=t.find("span[data-variable-name='damage']").first();r.addClass("trainer-buff-modification");var n=r.attr("data-variable-value"),s=r.text(),l=parseInt(n)*e,d=parseInt(s)+l;r.text(d)}if("Move_StartCharge_Abs"==i){var f=t.closest(".ability").first().find(".ability-mp").first();f.addClass("trainer-buff-modification");var d=parseInt(f.text())+e;f.text(d)}if("ModGem_Effect_Heal_Perc"==i){var r=t.find("span[data-variable-name='val3']").first();r.addClass("trainer-buff-modification");var n=r.attr("data-variable-value"),s=r.text(),l=parseInt(n)*e,d=parseInt(s)+l;r.text(d)}if("Move_Submission_Dmg_Perc"==i||"Move_Steal_Perc"==i){var r=t.find("span[data-variable-name='val1']").first();r.addClass("trainer-buff-modification");var n=r.attr("data-variable-value"),s=r.text(),l=parseInt(n)*e,d=parseInt(s)+l;r.text(d)}}function y(t,e,a){if("Gem_Dmg_Perc"==a){var i=$($(".gem-stats").first().find('[data-gem-type="'+t+'"]').first());i.addClass("trainer-buff-modification");var r=i.attr("data-variable-value"),n=i.text(),s=parseInt(r)*e,l=parseInt(n)+s;i.text(l)}if("Gem_Dmg_Abs"==a){var i=$($(".gem-stats").first().find('[data-gem-type="'+t+'"]').first()),r=i.attr("data-variable-value"),n=i.text(),l=parseInt(n)+e;i.text(l)}$(".gem-stat").each(function(t,e){var a=$(this).text();a=Math.round(a),$(this).text(a)})}function g(t,e,a,i,r){if(r){var n=r.data("effects"),s=r.data("buffed-id"),l=r.data("gem-type"),d=r.find(".ability-text").first();h(e,n,d,s,t,l)&&x(d,a,e,i)}else $(".ability").each(function(r,n){var s=$(this).data("effects"),l=$(this).data("buffed-id"),d=$(this).data("gem-type"),f=$(this).find(".ability-text").first();h(e,s,f,l,t,d)&&x(f,a,e,i)});$('span[data-variable-name="damage"], span[data-variable-name="val1"], span[data-variable-name="val2"], span[data-variable-name="val3"]').each(function(t,e){var a=$(this).text();a=Math.round(a),$(this).text(a)})}function I(t){$(".added-trainers").find('.trainer[data-activated="true"]').each(function(e,i){var r=$(i),n=1*r.attr("data-buff-value"),s=r.data("buff-gem-type"),l=r.data("buff-move-type");g(s,a(l),n,l,t),y(s,n,l)})}var _={},C={},M={},w=$("#wrestlerSlug").val();if(w){var S="3_3",k="Gold";$.getJSON("/db/wrestler/"+w+".json",function(t){_=t,s(),l(M.LevelCap)}),$.getJSON("/db/misc/trainers.json",function(t){C=t,r()}),$("#search").on("keyup keypress",function(t){if(13===(t.keyCode||t.which))return t.preventDefault(),!1;var e=$(this).val().toUpperCase();$(".add-trainer").each(function(){$(this).find(".wrestler-name").first().text().toUpperCase().indexOf(e)>-1?$(this).removeClass("hidden"):$(this).addClass("hidden")})}),$("#wrestlerLevelInput").on("input",function(){var t=$(this).val(),e=$("#wrestlerMaxLevel").val();$("#wrestlerLevelUI").text(t+"/"+e),o(M.Abilities,!0),d(t),I()}),$('input[name="stars"]').on("change",function(){S=$(this).val(),s(),l(),I()}),$('input[name="tier"]').on("change",function(){k=$(this).val(),s(),l(),I()}),$("input.trainer-level").on("input",function(){var t=parseInt($(this).val()),e=($(this).attr("max"),$($(this).closest(".trainer").first())),a=e.attr("data-activated"),r=e.find(".trainer-buff-text").first(),n=e.find(".trainer-talent-score").first(),s=e.attr("data-trainer-id"),l=i(s,t);parseInt(e.attr("data-buff-value")),l.buffValue;e.attr("data-buff-value",l.buffValue),n.empty(),n.text(l.talentScore+"/"+l.maxTalentScore),r.empty(),r.text(l.text),"true"===a&&(o(M.Abilities,!0),d(),I())})}})}});