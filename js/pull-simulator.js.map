{"version":3,"sources":["webpack:///webpack/bootstrap 024b386be9354a736d07?4f09********","webpack:///./assets/js/pull-simulator.js"],"names":["$","document","ready","oddsType","val","oddsSlug","oddsID","defaultPullsNumber","odds","getJSON","data","find","item","ID","initUI","doPull","fail","alert","items","Set","Pools","forEach","pool","Drops","drop","add","Item","empty","optionItemUI","value","text","append","on","e","preventDefault","serializeArray","reduce","obj","name","pullItem","console","log","doReversePull","pulls","reversePullItem","i","found","getItem","number","index","push","updateGUI","loadingUI","style","body","scrollIntoView","listUI","listItemUI","delay","fadeIn","intervalID","setTimeout","getTotalPoolsChance","pools","total","Number","Chance","getTotalPoolDropsChance","poolDrops","results","totalPoolsChance","p","Math","random","toFixed","cumulativePoolProbability","pickedPool","totalPoolsDropChance","r","cumulativeDropProbability","pickedItem"],"mappings":"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","file":"js/pull-simulator.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2996);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 024b386be9354a736d07","$(document).ready(function () {\n  var oddsType = $('#oddsType').val();\n  var oddsSlug = $('#oddsSlug').val();\n  var oddsID = $('#oddsID').val();\n  var defaultPullsNumber = $('#pullsNumber').val();\n\n  var odds = {};\n  $.getJSON('/api/odds/' + oddsType + '.json', function(data){\n    if (oddsType == 'oddsMega') {\n      odds = data.find(function(item) {\n        return item.ID == oddsID;\n      });\n    } else {\n      odds = data;\n    }\n    initUI(odds);\n    doPull(defaultPullsNumber);\n  })\n  .fail(function() {\n    alert(\"error\");\n  });\n\n  function initUI(odds) {\n    var items = new Set();\n    odds.Pools.forEach(function(pool){\n      pool.Drops.forEach(function(drop){\n        items.add(drop.Item);\n      });\n    });\n    //console.log([...items]);\n    $('#reversePullItems').empty();\n    for (let item of items) {\n      var optionItemUI = $('<option/>', {value: item, text: item});\n      $('#reversePullItems').append(optionItemUI);\n    }\n\n  }\n\n  $('#reversePullForm').on('submit', function(e) {\n    e.preventDefault();\n\n    var data = $(this).serializeArray().reduce(function(obj, item) {\n      obj[item.name] = item.value;\n      return obj;\n    }, {});\n\n    var pullItem = data[\"reverse-pull-item\"];\n    console.log(pullItem);\n    doReversePull(pullItem);\n\n  });\n\n  $('#pullForm').on('submit', function(e) {\n    e.preventDefault();\n\n    var data = $(this).serializeArray().reduce(function(obj, item) {\n      obj[item.name] = item.value;\n      return obj;\n    }, {});\n\n    var pulls = data[\"pulls\"];\n    doPull(pulls);\n\n  });\n\n  function doReversePull(reversePullItem) {\n    var i = 0;\n    var found = false;\n    while(!found) {\n      i++;\n      if (i >= 5000) {\n        console.log(\"Reached limit!\");\n        break;\n      }\n      var item = getItem(odds);\n      if (item.drop.Item == reversePullItem) {\n        found = true;\n        console.log(\"Found in \" + i + \" pulls\");\n      }\n    }\n    console.log(\"Done!\");\n  }\n\n  function doPull(number) {\n    /*\n    var distribution = {};\n    for (let index = 0; index < 100000; index++) {\n        var item = getItem(odds);\n        distribution[item.pool.Chance.toString() + ' pool'] = (distribution[item.pool.Chance.toString() + ' pool'] || 0) + 1;\n    }\n    console.log(distribution);\n    */\n   \n    var items = [];\n    for (let index = 0; index < number; index++) {\n        var item = getItem(odds);\n        items.push(item.drop.Item);\n    }\n    updateGUI(items);\n  }\n\n  function updateGUI(items) {\n    var loadingUI = $('<h4/>', {text: 'Loading...', style: 'text-align:center;'});\n    document.body.scrollIntoView();\n    $('#pullContent').empty();\n    $('#pullContent').append(loadingUI);\n\n    var listUI = $('<ol/>');\n    items.forEach(function(item, i){\n      var listItemUI = $('<li/>', {text: item});\n      listItemUI.delay(500 * i).fadeIn(500);\n      listUI.append(listItemUI);\n    });\n\n    var intervalID = setTimeout(function() { \n      $('#pullContent').empty();\n      $('#pullContent').append(listUI);\n    }, 500);\n  }\n\n\n  function getTotalPoolsChance(pools) {\n      var total = 0;\n      pools.forEach((pool) => {\n          total = total + Number(pool.Chance);\n      });\n      return total;\n  }\n\n  function getTotalPoolDropsChance(poolDrops) {\n      var total = 0;\n      poolDrops.forEach((drop) => {\n          total = total + Number(drop.Chance);\n      });\n      return total;\n  }\n\n  function getItem(results) {\n    var totalPoolsChance = getTotalPoolsChance(results.Pools);\n    var p = (Math.random() * totalPoolsChance).toFixed(2);\n    var cumulativePoolProbability = 0;\n    var pickedPool = results.Pools.find(pool => {\n        cumulativePoolProbability += Number(pool.Chance);\n        return (p <= cumulativePoolProbability);\n    });\n\n    var totalPoolsDropChance = getTotalPoolDropsChance(pickedPool.Drops);\n    var r = (Math.random() * totalPoolsDropChance).toFixed(2);\n    var cumulativeDropProbability = 0;\n    var pickedItem = pickedPool.Drops.find(drop => {\n        cumulativeDropProbability += Number(drop.Chance);\n        return (r <= cumulativeDropProbability);\n    });\n\n    return {'pool': pickedPool, 'drop': pickedItem};\n}\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/pull-simulator.js"],"sourceRoot":""}